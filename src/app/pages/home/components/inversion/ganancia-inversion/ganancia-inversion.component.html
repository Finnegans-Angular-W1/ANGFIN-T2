<div class="flex bg-[#f2f2f2] dark:bg-stone-800 flex-col items-center min-h-screen">
  <div class="w-full flex mt-28 md:mt-0">
    <div  class="card w-full bg-[#f2f2f2] mb-2 text-primary-content dark:bg-stone-800">
      <div class="card-body place-items-center">
        
        <div [formGroup]="form" (ngSubmit)="simularClick()" class="w-96 mb-8">

          <div class="form-control my-2">
            <h2 class="card-title dark:text-white">Inversiones</h2>
          </div>
          <div class="mb-2">
            <div class="form-control">
              <label class="dark:text-white font-semibold" 
              [ngClass]="{ 'text-red-800' : touchedAndInvalid('inversionInicial'), 'valid-label': !touchedAndInvalid('inversionInicial')}"
              >Cantidad a Invertir</label>
              <input type="number" placeholder="Ingrese cantidad" formControlName="inversionInicial" min="100"
                data-type="currency" required class="peer input-style w-full max-w-xs bg-white dark:text-white pl-2"
                [ngClass]="{'invalid-input':(form.controls['inversionInicial'].invalid && form.controls['inversionInicial'].touched),
              'valid-or-untouched-input': (form.controls['inversionInicial'].valid || form.controls['inversionInicial'].untouched)}">
            </div>
            <ng-container class="w-full min-h-max"
              *ngIf="touchedAndHasError('inversionInicial', 'required');  
              else mayor">
                  <span class="text-red-500 text-xs">Este campo es requerido.</span>
            </ng-container>
            <ng-template #mayor>
              <ng-container class="w-full min-h-max"
              *ngIf="touchedAndHasError('inversionInicial', 'max');
              else menor">
                  <span class="text-red-500 text-xs">El monto debe ser menor a $5.000.000.</span>
              </ng-container>
            </ng-template>
            <ng-template #menor>
              <ng-container class="w-full min-h-max"
              *ngIf="touchedAndHasError('inversionInicial', 'min');
              else mayorDisponible">
                  <span class="text-red-500 text-xs">El monto debe ser mayor a $100.</span>
              </ng-container>
            </ng-template>
            <ng-template #mayorDisponible>
              <ng-container class="w-full min-h-max"
              *ngIf="clickInvertir() == true">
                  <span class="text-red-500 text-xs">El monto debe ser menor a lo disponible en cuenta.</span>
              </ng-container>
            </ng-template>
          </div>

          <div class="mb-3">
            <div class="form-control mb-3">
              <label class="dark:text-white font-semibold mb-1" 
                [ngClass]="{ 'text-red-800' : touchedAndInvalid('plazo'), 'valid-label': !touchedAndInvalid('plazo')}">
                Plazo en Días</label>
              <select type="date" formControlName="plazo" placeholder="Elegir plazo en días" required
                class="peer input-style w-full max-w-xs bg-white dark:text-white pl-2"
                [ngClass]="{'invalid-input':(form.controls['plazo'].invalid && form.controls['plazo'].touched),
              'valid-or-untouched-input': (form.controls['plazo'].valid || form.controls['plazo'].untouched)}">
                <option value="" disabled selected>Seleccionar plazo</option>
                <option value="30">30 días</option>
                <option value="60">60 días</option>
                <option value="90">90 días</option>
                <option value="120">120 días</option>
                <option value="150">150 días</option>
              </select>
            </div>
            <ng-container class="w-full min-h-max"
              *ngIf="touchedAndHasError('plazo', 'required');">
                  <span class="text-red-500 text-xs">Este campo es requerido.</span>
            </ng-container>
          </div>
         

          <div class="form-control mb-2">
            <label class="dark:text-white font-semibold mb-1">Fecha de finalización</label>
            <label class="peer input-style bg-white w-full h-8
              max-w-xs text-[#97a2a8] dark:text-white pl-2"> <!-- textarea textarea-bordered textarea-success w-full  -->
              {{ calcularFechaFinal() }}</label>
            <br>
          </div>

          <div class="card-actions items-center">
            <div class="grid grid-cols-2 my-1">
              <div class="form-control w-36 ml-2">
                <button type="reset" class="btn border-transparent text-white 
                  bg-[#939ca1]" (click)="cancelarClick()">Cancelar</button>
              </div>
              <div class="form-control w-36 ml-2">
                <button type="submit" class="btn border-transparent text-white 
                  bg-accent" [disabled]="form.invalid" (click)="simularClick()">Simular</button>
              </div>
            </div>
          </div>


        </div>

        <ng-container *ngIf="visible">
          <div class="w-full ">
            <div class="grid grid-cols-4 my-5 justify-items-center items-center">
              <div>
                <label class="font-semibold dark:text-[#FFDE38]">Ganancia Mensual Estimada: </label>
                <label class="w-full max-w-xs text-stone-700 text-center dark:text-white">
                  {{ calcularGanancia() | currency }}</label>
                <br>
              </div>

              <div>
                <label class="font-semibold  dark:text-[#FFDE38]">Total: </label>
                <label class="w-full max-w-xs text-stone-700 text-center dark:text-white">
                  {{ calcularTotal() | currency }}</label>
                <br>
              </div>
              <div class="">
                <button (click)="clickProyectar()" class="btn border-transparent text-white 
                bg-accent">Proyectar</button>
              </div>
              <div class="">
                <!--button (click)="clickInvertir()" class="btn border-transparent text-white 
                bg-accent">Invertir</button-->
                
                <label for="my-modal-3" class="btn border-transparent text-white bg-accent">Solicitar</label>

                <input type="checkbox" id="my-modal-3" class="modal-toggle" />
                <div class="modal" *ngIf="clickInvertir() == false">
                  <div class="modal-box relative">
                    <label for="my-modal-3" class="btn btn-sm btn-circle absolute right-2 top-2">✕</label>
                    <h3 class="text-lg font-bold text-center">¡Gracias por confiar en nosotros!</h3>
                    <p class="py-4 text-center">En unos instantes verás reflejada la solicitud de tu plazo fijo.</p>
                  </div>
                </div>
              </div>
            </div>

            <app-plazofijo-chart [amountInversion]="inversionBehavior"></app-plazofijo-chart>

          </div>

        </ng-container>

      </div>
  </div>
</div>